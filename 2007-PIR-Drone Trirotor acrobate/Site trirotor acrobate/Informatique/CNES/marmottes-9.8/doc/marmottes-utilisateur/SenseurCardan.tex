% -*- mode: latex; tex-main-file: "marmottes-utilisateur.tex" -*-
% $Id: SenseurCardan.tex,v 1.11 2003/07/09 09:24:58 marmottes Exp $
\subsection{classe SenseurCardan}\label{sec:SenseurCardan}

\subsubsection*{description}\label{sec:SenseurCardan-desc}

Cette classe implante les senseurs de Cardan, c'est à dire les
senseurs qui modélisent des rotations successives à partir d'un repère
de référence. Plusieurs repères de référence sont disponibles :
\begin{description}
\item[géocentrique :] ce repère est défini par l'axe $\vec{Z}$ qui
pointe vers le centre terre et l'axe $\vec{Y}$ qui est opposé au
moment orbital, l'axe $\vec{X}$ déduit des deux précédents est dans le
plan de l'orbite, dans le même sens que la vitesse ;
\item[orbital TNW :] ce repère est défini par l'axe $\vec{X}$ qui est
porté par le vecteur vitesse (on le note souvent $\vec{T}$ dans ce
cas) et l'axe $\vec{Z}$ qui est porté par le moment orbital (on le
note souvent $\vec{W}$ dans ce cas), l'axe $\vec{Y}$ déduit des deux
précédents est dans le plan de l'orbite, dans le sens du nadir (on le
note souvent $\vec{N}$ dans ce cas) ;
\item[orbital QSW :] ce repère est défini par l'axe $\vec{X}$ qui est
pointe à l'opposé du centre terre (on le note souvent $\vec{Q}$ dans
ce cas) et l'axe $\vec{Z}$ qui est porté par le moment orbital (on le
note souvent $\vec{W}$ dans ce cas), l'axe $\vec{Y}$ déduit des deux
précédents est dans le plan de l'orbite, dans le sens de la vitesse (on le
note souvent $\vec{S}$ dans ce cas) ;
\item[inertiel :] ce repère est directement le repère inertiel à
partir duquel les position, vitesse et attitude sont exprimées :
\item[topocentrique :] ce repère est défini par l'axe $\vec{Z}$ qui
pointe vers le centre terre et l'axe $\vec{Y}$ qui pointe vers l'Est,
l'axe $\vec{X}$ déduit des deux précédents est dans le plan méridien,
positif vers le Sud ;
\item[utilisateur :] ce repère n'est pas prédéfini dans le code, il
est spécifié par l'utilisateur dynamiquement, il peut très bien être
modifié à chaque pas de calcul (par exemple à partir de l'attitude
donnée par un autre simulateur \bibliotheque{marmottes}, pour évaluer
des erreurs de pilotages autour d'une attitude nominale).
\end{description}

Si les mesures de roulis, tangage et lacet sont simultanément nulles,
le repère senseur est aligné avec le repère de référence.

\subsubsection*{interface publique}\label{sec:SenseurCardan-int}
\begin{verbatim}
#include "marmottes/SenseurCardan.h"
\end{verbatim}

\begin{verbatim}
  enum typeGenre     { GenreInconnu,
                       LRTLacet,   LRTRoulis,  LRTTangage,
                       LTRLacet,   LTRTangage, LTRRoulis,
                       RLTRoulis,  RLTLacet,   RLTTangage,
                       RTLRoulis,  RTLTangage, RTLLacet,
                       TLRTangage, TLRLacet,   TLRRoulis,
                       TRLTangage, TRLRoulis,  TRLLacet
                     };

  enum typeReference { ReferenceInconnue,
                       Geocentrique, OrbitalTNW,    OrbitalQSW,
                       Inertiel,     Topocentrique, Utilisateur
                     };
\end{verbatim}

\begin{tableFonctionsFixe}{SenseurCardan : méthodes publiques}
{\label{tab:SenseurCardan-met-pub}}
{force le senseur à convertir les unités de mesures dans ses sorties}

\signature{\fonc{SenseurCardan}}
          {(int \argument{variation},\\
            const string\& \argument{nom},\\
            const RotDBL\& \argument{repere},\\
            const VecDBL\& \argument{axeCalage},\\
            double \argument{precision})
          }&

construit une instance à partir des données technologiques\\

\hline

\signature{\fonc{SenseurCardan}}
          {(const SenseurCardan\& \argument{s})}&

constructeur par copie\\

\signature{SenseurCardan\& \fonc{operator =}}
          {(const SenseurCardan\& \argument{s})}&

affectation\\

\hline

\signature{\fonc{\~{}SenseurCardan} ()}
          {}&

destructeur, ne fait rien dans cette classe\\

\hline

\signature{void \fonc{respecterMesures} ()}
          {}&

force le senseur à respecter les unités de mesures dans ses sorties\\

\signature{void \fonc{convertirMesures} ()}
          {}&

force le senseur à convertir les unités de mesures dans ses sorties\\

\hline

\signature{Senseur* \fonc{copie} () const}
          {}&

opérateur de copie virtuel\\

\signature{typeGeom \fonc{typeGeometrique} () const}
          {}&

retourne le type de senseur géométrique (pseudoSenseur)\\

\hline

\signature{double \fonc{mesure} (const Etat\& \argument{etat})}
          {\throw{MarmottesErreurs}}&

retourne la mesure que produirait le senseur dans l'\argument{etat}
fourni\\

\signature{int \fonc{controlable} (const Etat\& \argument{etat})}
          {\throw{MarmottesErreurs}}&

indique si le senseur serait capable de contrôler le satellite dans
l'\argument{etat} fourni\\

\signature{void \fonc{modeliseConsigne}}
          {(const Etat\& \argument{etat}, double \argument{valeur})\\
          \throw{CantorErreurs, MarmottesErreurs}}&

modélise la consigne \argument{valeur} dans l'\argument{etat} fourni\\

\hline

\signature{void \fonc{modifieReference}}
          {(const RotDBL\& \argument{reference})\\
          \throw{MarmottesErreurs}}&

mémorise le repère de \argument{reference}. Cette méthode n'est
utilisable que si le fichier de description du senseur indique que le
repère doit être fourni par l'utilisateur (type de référence :
\texttt{Utilisateur}).
\end{tableFonctionsFixe}
\subsubsection*{implantation}\label{sec:SenseurCardan-impl}
Les attributs privés sont décrits sommairement dans la
table~\ref{tab:SenseurCardan-att-priv}, il n'y a pas d'attribut protégé.
\begin{tableAttributsFixe}{attributs privés de la classe SenseurCardan}
{\label{tab:SenseurCardan-att-priv}}
{projection de l'axe $\vec{x}$ du senseur en repère inertiel}
genre\_&
typeGenre&

indique le type de senseur de Cardan modélisé\\

reference\_&
typeReference&

indique le type de repère de référence\\

refUtilInitialisee\_&
bool&

indique si la référence utilisateur est initialisée\\

referenceUtilisateur\_&
RotDBL&

repère de référence donné par l'utilisateur\\

xIn\_&
VecDBL&

projection de l'axe $\vec{x}$ du repère de référence en repère inertiel\\

yIn\_&
VecDBL&

projection de l'axe $\vec{y}$ du repère de référence en repère inertiel\\

zIn\_&
VecDBL&

projection de l'axe $\vec{z}$ du repère de référence en repère inertiel\\
\end{tableAttributsFixe}

Les méthodes protégées sont décrites dans la table~\ref{tab:SenseurCardan-met-prot}.
\begin{tableFonctionsFixe}{SenseurCardan : méthodes protégées}
{\label{tab:SenseurCardan-met-prot}}
{constructeur par défaut. Il est défini explicitement uniquement pour }

\signature{\fonc{SenseurCardan} ()}
          {}&

constructeur par défaut. Il est défini explicitement uniquement pour
prévenir celui créé automatiquement par le compilateur et ne doit pas être
utilisé.
\\
\end{tableFonctionsFixe}

Les méthodes privées sont décrites dans la table~\ref{tab:SenseurCardan-met-priv}.
\begin{tableFonctionsFixe}{SenseurCardan : méthodes privées}
{\label{tab:SenseurCardan-met-priv}}
{met à jour le repère de référence en fonction}

\signature{int \fonc{metAJourReference} (const Etat\& \argument{etat})}
          {\throw{MarmottesErreurs}}&

met à jour le repère de référence en fonction de l'\argument{etat}
spécifié.
\end{tableFonctionsFixe}

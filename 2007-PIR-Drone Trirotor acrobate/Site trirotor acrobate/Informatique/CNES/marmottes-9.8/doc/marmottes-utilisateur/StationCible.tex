% -*- mode: latex; tex-main-file: "marmottes-utilisateur.tex" -*-
% $Id: StationCible.tex,v 1.3 1999/08/20 07:13:06 filaire Exp $
\subsection{classe StationCible}\label{sec:StationCible}

\subsubsection*{description}\label{sec:StationCible-desc}

Cette classe modélise une station sol telle qu'elle peut voir un
satellite ; elle est utilisée en tant que cible de certains senseurs
optiques.
\subsubsection*{interface publique}\label{sec:StationCible-int}
\begin{verbatim}
#include "marmottes/StationCible.h"
\end{verbatim}
\begin{tableFonctionsFixe}{StationCible : méthodes publiques}
{\label{tab:StationCible-met-pub}}
{construit une station à partir de ses coordonnées}

\signature{\fonc{StationCible} ()}
          {}&

constructeur par défaut\\

\signature{\fonc{StationCible}}
          {(double \argument{pression}, double \argument{temperature},\\
            double \argument{hygrometrie},\\
            double \argument{longitude}, double \argument{latitude},\\
            double \argument{altitude},\\
            int \argument{nbPtsMasque},\\
            const double masqueAz [], const double masqueSi [])
          }&

construit une station à partir de ses coordonnées et des conditions
atmosphériques associées\\

\hline

\signature{\fonc{StationCible} (const StationCible\& \argument{s})}
          {}&

constructeur par copie\\

\signature{StationCible\& \fonc{operator =} (const StationCible\& \argument{s})}
          {}&

affectation\\

\hline

\signature{\fonc{\~{}StationCible} ()}
          {}&

destructeur, libère la mémoire allouée pour le masque d'antenne\\

\hline

\signature{VecDBL \fonc{position} () const}
          {}&

retourne la position par rapport au repère terrestre\\

\hline

\signature{void \fonc{correctionTropo}}
          {(double \argument{siteMesure},\\
            double* \argument{dSite}, double* \argument{dDist}) const
          }&

calcule les corrections troposphériques en site et en distance pour le
site mesuré\\

\signature{void \fonc{correctionTropoInverse}}
          {(double \argument{siteTheorique},\\
            double* \argument{dSite}, double* \argument{dDist}) const
          }&

calcule l'inverse des corrections troposphériques en site et en
distance pour le site théorique\\

\hline

\signature{double \fonc{siteObservePt} (const VecDBL\& \argument{p}) const}
          {}&

retourne le site observé pour un vecteur regardant le point $\vec{p}$
en repère terrestre\\

\signature{double \fonc{siteTheoriquePt} (const VecDBL\& \argument{p}) const}
          {}&

retourne le site théorique pour un vecteur regardant le point
$\vec{p}$ en repère terrestre\\

\signature{double \fonc{azimutPt} (const VecDBL\& \argument{p}) const}
          {}&

retourne l'azimut pour un vecteur regardant le point $\vec{p}$ en
repère terrestre\\

\hline

\signature{double \fonc{masque} (double \argument{azimut}) const}
          {}&

retourne le masque d'antenne (site minimal) dans l'azimut spécifié\\

\signature{int \fonc{visiblePt} (const VecDBL\& \argument{p}) const}
          {}&

indique si le point $\vec{p}$ est visible (c'est à dire s'il est
au-dessus du masque d'antenne, en tenant compte de l'effet
troposphérique)\\

\end{tableFonctionsFixe}
\subsubsection*{exemple d'utilisation}

\begin{verbatim}
#include "marmottes/StationCible.h"
...
void SenseurOptique::initialiseCible (const Etat& etat)
  throw (MarmottesErreurs)
{ // initialisation de la direction de la cible en repère inertiel

  switch (code_)
  {
    ...

    case codeStation :
      { // encapsulation du cas entre "{}" pour limiter la portée
        // des variables locales
        etat.normesLitigieuses ();

        RotDBL terreInert (VecDBL (0.0, 0.0, 1.0), etat.tempsSideral ());
        cible_ = terreInert (station_.position ()) - etat.position ();
        cible_.normalise ();

      }
      break;

    ...

  }

  // on fait la conversion en développement limité une fois pour toutes
  cibleVD1_ = VecDBLVD1 (cible_);

}

int SenseurOptique::visible (const Etat& etat, const VecDBL& u) const
{ if (ptrChampDeVue_)
  { if (code_ == codeStation)
    { VecDBL v = etat.attitude () (u);

      RotDBL inertTerre (VecDBL (0.0, 0.0, 1.0), -(etat.tempsSideral ()));

      return (ptrChampDeVue_->inclus (v)
              &&
              station_.visiblePt (inertTerre (etat.position ())));

    }
    else
    { VecDBL v = etat.attitude () (u);
      return ptrChampDeVue_->inclus (v);
    }
  }
  else
    return 0;
}

\end{verbatim}

\subsubsection*{conseils d'utilisation spécifiques}
\label{sec:StationCible-conseils}
La classe station est destinée principalement à modéliser des liaisons
bord-sol par l'intermédiaire de pseudo-senseurs. La visibilité de la
station dans le lobe d'antenne bord peut être modélisée par un champ
de vue. La visibilité du satellite dans le lobe d'antenne sol est
calculée en tenant compte de la forme ellipsoïdale de la terre et des
effets troposphériques. Il faut donc prendre garde que la visibilité
est limitée par le sol et par le bord de façon indépendante.

\subsubsection*{implantation}\label{sec:StationCible-impl}
Les attributs privés sont décrits sommairement dans la
table~\ref{tab:StationCible-att-priv}, il n'y a pas d'attribut protégé.
\begin{tableAttributsFixe}{attributs privés de la classe StationCible}
{\label{tab:StationCible-att-priv}}
{altitude de la station au dessus de l'ellipsoïde terrestre}

pression\_ & double  & pression atmosphérique au sol\\

temperature\_ & double  & température au sol\\

hygrometrie\_ & double  & hygrométrie au sol\\

\hline

altitude\_ & double  & altitude de la station au dessus de l'ellipsoïde
terrestre\\

position\_ & VecDBL  & position de la station en repère terrestre\\

nordEstNadir\_ & RotDBL  & orientation du repère topocentrique local
par rapport au repère terrestre\\

\hline

nbPtsMasque\_ & int  & nombre de points du masque d'antenne\\

masqueAz\_ & double * & table des azimuts du masque d'antenne\\

masqueSi\_ & double * & table des sites du masque d'antenne\\

\end{tableAttributsFixe}
Les méthodes privées sont décrites dans la table~\ref{tab:StationCible-met-priv}.
\begin{tableFonctionsFixe}{StationCible : méthodes privées}
{\label{tab:StationCible-met-priv}}
{initialise la position de la station à partir de ses coordonnées}

\signature{void \fonc{initCoord}}
          {(double \argument{longitude}, double \argument{lagitude},\\
            double \argument{altitude})
          }&

initialise la position de la station à partir de ses coordonnées sur
l'ellipsoïde\\


\signature{void \fonc{initMasque}}
          {(int \argument{nbPtsMasque},\\
            const double masqueAz [],\\
            const double masqueSi [])
          }&

initialise le masque d'antenne\\

\end{tableFonctionsFixe}

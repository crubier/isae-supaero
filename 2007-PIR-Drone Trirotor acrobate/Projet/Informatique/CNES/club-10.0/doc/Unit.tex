% -*- mode: latex; tex-main-file: "club.tex" -*-
% $Id: Unit.tex,v 1.3 2005/03/11 16:38:35 chope Exp $
\subsection{classe Unit}\label{sec:Unit}
\begin{changebar}

\subsubsection{description}\label{sec:Unit-desc}

Cette classe représente une unité particulière, pouvant intervenir
dans des conversions de valeurs numériques entre unités.
\subsubsection{interface publique}\label{sec:Unit-int}
\begin{verbatim}
#include "club/Unit.h"
\end{verbatim}
\begin{tableFonctionsFixe}{Unit : méthodes publiques}
{\label{tab:Unit-met-pub}}
{construit une unité à partir de son symbole, de ses dimensions,}

\signature{\fonc{Unit} ()}{}
&
construit une unité par défaut sans aucune dimension
\\

\signature{\fonc{Unit}}
          {(const XMLCh* \argument{symbol},\\
           int \argument{dimLength}, int \argument{dimMass}, int \argument{dimTime},\\
           int \argument{dimElectricCurrent}, int \argument{dimTemperature},\\
           int \argument{dimAmountOfSubstance},\\
           int \argument{dimLuminousIntensity},\\
           int \argument{dimPlanarAngle}, int \argument{dimSolidAngle},\\
           double \argument{offset}, double \argument{factor})}
&
construit une unité à partir de son symbole, de ses dimensions, et des
caractéristiques de conversion la reliant à l'unité par défaut ayant
les mêmes dimensions
\\

\signature{\fonc{Unit}}
          {(const XMLCh* \argument{symbol},\\
            const Unit\& \argument{unit1}, int \argument{exponent1},\\
            const Unit\& \argument{unit2}, int \argument{exponent2})}
&

construit une unité par combinaison multiplicative de deux autres
unités (voir la section~\ref{sec:Unit-conseils} pour des précisions
sur cette combinaison)
\\

\signature{\fonc{Unit} (const Unit \&\argument{u})}{}
&
constructeur par copie
\\

\signature{Unit\&  \fonc{operator =} (const Unit\& \argument{u})}{}
&
affectation
\\

\hline
\signature{const XMLCh* \fonc{getSymbol} () const}{}
&
retourne le symbole de l'unité
\\

\signature{void \fonc{setSymbol} (const XMLCh* \argument{symbol})}{}
&
modifie le symbole de l'unité
\\

\signature{bool \fonc{isCompatibleWith} (const Unit\& \argument{u}) const}{}
&
indique si l'unité est compatible avec une autre, c'est-à-dire si une
valeur ayant cette unité peut être convertie en une valeur ayant
l'autre unité
\\

\hline
\signature{double \fonc{fromReference} (double \argument{value}) const}{}
&
convertit la valeur spécifiée considérée comme exprimée dans l'unité par défaut ayant
les mêmes dimensions en une valeur considérée comme exprimée dans
l'unité de l'instance
\\

\signature{double \fonc{toReference} (double \argument{value}) const}{}
&
convertit la valeur spécifiée considérée comme exprimée dans l'unité
de l'instance en une valeur considérée comme exprimée dans l'unité par
défaut ayant les mêmes dimensions
\\

\end{tableFonctionsFixe}
\subsubsection{exemple d'utilisation}

\begin{verbatim}
#include "club/Unit.h"

Unit  m (XMLString::transcode("m"),  1, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 1.0);
Unit km (XMLString::transcode("km"), 1, 0, 0, 0, 0, 0, 0, 0, 0, 0.0, 1000.0);
Unit  s (XMLString::transcode("s"),  0, 0, 1, 0, 0, 0, 0, 0, 0, 0.0, 1.0);
Unit  h (XMLString::transcode("h"),  0, 0, 1, 0, 0, 0, 0, 0, 0, 0.0, 3600.0);

Unit  mPerS (XMLString::transcode("m/s"),   m, 1, s, -1);
Unit kmPerH (XMLString::transcode("km/h"), km, 1, h, -1);

// convert a value from km/h into m/s
cout << mPerS.fromReference (kmPerH.toReference (130.0)) << endl;

\end{verbatim}

\subsubsection{conseils d'utilisation spécifiques}\label{sec:Unit-conseils}

La combinaison multiplicative d'unités réalisée par le constructeur
prenant deux unités et les exposants associés élimine les décalages (argument
\argument{offset} dans la construction des unités élémentaires). Ce
comportement \emph{a priori} surprenant est tout à fait logique. En
effet, les combinaisons multiplicatives ont une signification relative
et non absolue. À titre d'exemple, l'unité \textsl{degré Celsius par
mètre} représente un gradient de température lié à une différence de
température pour une différence de position. Ceci implique qu'une
valeur de 1 degré Celsius par mètre est convertie en 1,8 degré
Fahrenheit par mètre alors qu'une température thermodynamique de 1
degré Celsius est convertie en 33,8 degrés Fahrenheit.

Dans la pratique, même pour des unités élémentaires, il faudrait
pouvoir savoir si l'on convertit des données absolues ou relatives
(pour reprendre l'exemple précédent, une variation de température
thermodynamique de 1 degré Celsius devrait être convertie en une
variation de 1,8 degré Fahrenheit). Cette distinction n'est pas
implémentée car elle ne peut être levée que par le contexte (en fait,
même l'écriture physique usuelle ne permet pas de différencier une valeur
relative d'une valeur absolue).

Les seules unités présentant ces problèmes sont les températures
thermodynamiques (et elles présentent le problème pour toutes les
conversions : Celsius, Fahrenheit et Kelvin). Le compromis adopté
et qui consiste à supprimer le décalage pour les combinaisons d'unités
semble raisonnable et pragmatique.

\subsubsection{implantation}\label{sec:Unit-impl}
Les attributs privés sont décrits sommairement dans la
table~\ref{tab:Unit-att-priv}, il n'y a pas d'attribut protégé.
\begin{tableAttributsFixe}{attributs privés de la classe Unit}
{\label{tab:Unit-att-priv}}
{dimension de l'unité selon l'axe des températures thermodynamiques}

symbol\_ & const XMLCh*  & symbole de l'unité\\

\hline
dimLength\_ & int  & dimension de l'unité selon l'axe des longueurs\\

dimMass\_ & int  & dimension de l'unité selon l'axe des masses\\

dimTime\_ & int  & dimension de l'unité selon l'axe des temps\\

dimElectricCurrent\_ & int  & dimension de l'unité selon l'axe des
courants électriques\\

dimTemperature\_ & int  & dimension de l'unité selon l'axe des
températures thermodynamiques\\

dimAmountOfSubstance\_ & int  & dimension de l'unité selon l'axe des
quantités de matière\\

dimLuminousIntensity\_ & int  & dimension de l'unité selon l'axe des
intensités lumineuses\\

dimPlanarAngle\_ & int  & dimension de l'unité selon l'axe des angles plans\\

dimSolidAngle\_ & int  & dimension de l'unité selon l'axe des angles solides\\

\hline
offset\_ & double  & décalage de l'unité par rapport à l'unité de
référence ($v_{\mathrm{ref}} = v_{\mathrm{u}} \times f + o$)\\

factor\_ & double  & facteur multiplicatif de l'unité par rapport à
l'unité de référence ($v_{\mathrm{ref}} = v_{\mathrm{u}} \times f + o$)\\

\end{tableAttributsFixe}

\end{changebar}
